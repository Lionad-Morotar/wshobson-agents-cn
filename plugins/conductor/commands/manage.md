---
description: "管理轨道生命周期：归档、恢复、删除、重命名和清理"
argument-hint: "[--archive | --restore | --delete | --rename | --list | --cleanup]"
---

# 轨道管理器

管理完整的轨道生命周期，包括归档、恢复、删除、重命名和清理孤立工件。

## 预检查

1. 验证 Conductor 已初始化：
   - 检查 `conductor/product.md` 存在
   - 检查 `conductor/tracks.md` 存在
   - 检查 `conductor/tracks/` 目录存在
   - 如果缺失：显示错误并建议先运行 `/conductor:setup`

2. 确保归档目录存在（用于归档/恢复操作）：
   - 检查 `conductor/tracks/_archive/` 是否存在
   - 执行归档操作时如需要则创建

## 模式检测

解析参数以确定操作模式：

| 参数                   | 模式         | 描述                                       |
| ---------------------- | ------------ | ----------------------------------------- |
| `--list [filter]`      | 列表         | 显示所有轨道（可选：active、completed、archived） |
| `--archive <id>`       | 归档         | 将已完成轨道移至归档                         |
| `--archive --bulk`     | 批量归档     | 多选已完成轨道                             |
| `--restore <id>`       | 恢复         | 将已归档轨道恢复为活动状态                   |
| `--delete <id>`        | 删除         | 永久移除轨道                               |
| `--rename <old> <new>` | 重命名       | 更改轨道 ID                               |
| `--cleanup`            | 清理         | 检测并修复孤立工件                         |
| (无)                   | 交互式       | 菜单驱动的操作选择                         |

---

## 交互式模式（无参数）

当不带参数调用时，显示主菜单：

### 1. 收集快速统计

读取 `conductor/tracks.md` 并扫描目录：

- 统计活动轨道（状态 `[ ]` 或 `[~]`）
- 统计已完成轨道（状态 `[x]`，未归档）
- 统计已归档轨道（在 `_archive/` 目录中）

### 2. 显示主菜单

```
================================================================================
                          轨道管理器
================================================================================

您想做什么？

1. 列出所有轨道
2. 归档已完成轨道
3. 恢复已归档轨道
4. 永久删除轨道
5. 重命名轨道
6. 清理孤立工件
7. 退出

快速统计：
- {N} 个活动轨道
- {M} 个已完成（可归档）
- {P} 个已归档

选择选项：
```

### 3. 处理选择

- 选项 1：执行列表模式
- 选项 2：执行归档模式（无参数）
- 选项 3：执行恢复模式（无参数）
- 选项 4：执行删除模式（无参数）
- 选项 5：执行重命名模式（无参数）
- 选项 6：执行清理模式
- 选项 7：退出并显示"轨道管理已取消。"

---

## 列表模式 (`--list`)

显示全面的轨道概览，具有可选过滤。

### 1. 数据收集

**对于活动轨道：**

- 读取 `conductor/tracks.md`
- 对于每个状态为 `[ ]` 或 `[~]` 的轨道：
  - 读取 `conductor/tracks/{trackId}/metadata.json` 以获取类型、日期
  - 读取 `conductor/tracks/{trackId}/plan.md` 以获取任务计数
  - 计算进度百分比

**对于已完成轨道：**

- 查找状态为 `[x]` 且不在 `_archive/` 中的轨道
- 读取元数据以获取完成日期

**对于已归档轨道：**

- 扫描 `conductor/tracks/_archive/` 目录
- 读取每个 `metadata.json` 以获取归档原因和日期

### 2. 输出格式

**完整列表（无过滤）：**

```
================================================================================
                          轨道管理器
================================================================================

活动轨道 ({count})
| 状态 | 轨道 ID           | 类型    | 进度       | 更新时间   |
|--------|-------------------|---------|------------|------------|
| [~]    | dashboard_20250112| 功能 | 7/15 (47%)  | 2025-01-15 |
| [ ]    | nav-fix_20250114  | Bug   | 0/4 (0%)    | 2025-01-14 |

已完成轨道 ({count})
| 轨道 ID           | 类型    | 完成时间   | 时长 |
|-------------------|---------|------------|----------|
| auth_20250110     | 功能 | 2025-01-12 | 2 天   |

已归档轨道 ({count})
| 轨道 ID              | 类型    | 原因      | 归档时间   |
|-----------------------|---------|------------|------------|
| old-feature_20241201  | 功能 | 被取代   | 2025-01-05 |

================================================================================
命令：/conductor:manage --archive | --restore | --delete | --rename | --cleanup
================================================================================
```

**过滤列表（`--list active`、`--list completed`、`--list archived`）：**

仅显示请求的部分，格式相同。

### 3. 空状态

**完全没有轨道：**

```
================================================================================
                          轨道管理器
================================================================================

未找到轨道。

创建您的第一个轨道：/conductor:new-track

================================================================================
```

**过滤中没有轨道：**

```
================================================================================
                          轨道管理器
================================================================================

未找到 {filter} 轨道。

================================================================================
```

---

## 归档模式 (`--archive`)

将已完成轨道移至归档目录。

### 带参数 (`--archive <track-id>`)

#### 1. 验证轨道

- 检查轨道存在于 `conductor/tracks/{track-id}/`
- 如果未找到，显示错误并列出可用轨道：

  ```
  错误：未找到轨道：{track-id}

  可用轨道：
  - auth_20250110（已完成）
  - dashboard_20250112（进行中）

  用法：/conductor:manage --archive <track-id>
  ```

- 检查轨道尚未归档（不在 `_archive/` 中）
- 如果已归档：

  ```
  错误：轨道 '{track-id}' 已归档。

  归档时间：{archived_at}
  原因：   {archive_reason}
  位置：conductor/tracks/_archive/{track-id}/

  恢复：/conductor:manage --restore {track-id}
  ```

#### 2. 验证完成状态

读取 `conductor/tracks/{track-id}/metadata.json` 和 `plan.md`：

- 如果状态不是 `completed` 或 `[x]`：

  ```
  轨道 '{track-id}' 未标记为完成。

  当前状态：{status}
  任务：{completed}/{total} 完成

  选项：
  1. 无论如何归档（不推荐）
  2. 取消并先完成轨道
  3. 查看轨道状态

  选择选项：
  ```

- 如果选择选项 1，继续并显示警告
- 如果选择选项 2 或 3，退出或显示状态

#### 3. 提示归档原因

```
您为什么要归档此轨道？

1. 已完成 - 工作成功完成
2. 被取代 - 被另一个轨道替换
3. 已放弃 - 不再需要
4. 其他（指定）

选择原因：
```

如果选择"其他"，提示输入自定义原因。

#### 4. 显示确认

```
================================================================================
                          归档确认
================================================================================

轨道：    {track-id} - {title}
类型：     {type}
状态：   {status}
任务：    {completed}/{total} 完成
原因：   {reason}

操作：
- 将 conductor/tracks/{track-id}/ 移至 conductor/tracks/_archive/{track-id}/
- 更新 conductor/tracks.md（移至已归档轨道部分）
- 使用归档信息更新 metadata.json
- 创建 git 提交：chore(conductor): 归档轨道 '{title}'

================================================================================

输入 'YES' 以继续，或输入任何其他内容取消：
```

**关键：需要明确的 'YES' 确认。**

#### 5. 执行归档

1. 如果不存在则创建 `conductor/tracks/_archive/`：

   ```bash
   mkdir -p conductor/tracks/_archive
   ```

2. 移动轨道目录：

   ```bash
   mv conductor/tracks/{track-id} conductor/tracks/_archive/
   ```

3. 更新 `conductor/tracks/_archive/{track-id}/metadata.json`：

   ```json
   {
     "archived": true,
     "archived_at": "ISO_TIMESTAMP",
     "archive_reason": "{reason}",
     "status": "archived"
   }
   ```

4. 更新 `conductor/tracks.md`：
   - 从活动轨道或已完成轨道部分移除条目
   - 将条目添加到已归档轨道部分，格式为：

     ```markdown
     ### {track-id}: {title}

     **原因：** {reason}
     **归档时间：** YYYY-MM-DD
     **文件夹：** [./tracks/_archive/{track-id}/](./tracks/_archive/{track-id}/)
     ```

5. Git 提交：
   ```bash
   git add conductor/tracks/_archive/{track-id} conductor/tracks.md
   git commit -m "chore(conductor): 归档轨道 '{title}'"
   ```

#### 6. 成功输出

```
================================================================================
                          归档完成
================================================================================

轨道已归档：{track-id} - {title}

位置：  conductor/tracks/_archive/{track-id}/
原因：    {reason}
提交：    {sha}

恢复：/conductor:manage --restore {track-id}
列表：    /conductor:manage --list archived

================================================================================
```

### 不带参数 (`--archive`)

#### 1. 查找可归档轨道

扫描尚未归档的已完成轨道：

- tracks.md 中的状态 `[x]`
- 不在 `_archive/` 目录中

#### 2. 显示选择菜单

```
================================================================================
                          归档轨道
================================================================================

可用于归档的已完成轨道：

1. [x] auth_20250110 - 用户身份验证（完成于 2025-01-12）
2. [x] setup-ci_20250108 - CI 流水线设置（完成于 2025-01-09）

已归档：{N} 个轨道

--------------------------------------------------------------------------------

选项：
1-{N}. 选择要归档的轨道
A.     归档所有已完成轨道
C.     取消

选择选项：
```

- 如果是数字，继续单个归档流程
- 如果是 'A'，继续批量归档
- 如果是 'C'，退出

#### 3. 无可归档轨道

```
================================================================================
                          归档轨道
================================================================================

没有可用于归档的已完成轨道。

当前轨道：
- [~] nav-fix_20250114 - 进行中
- [ ] api-v2_20250115 - 待处理

已归档：{N} 个轨道（使用 --list archived 查看）

================================================================================
```

### 批量归档 (`--archive --bulk`)

#### 1. 显示多选

```
================================================================================
                       批量归档选择
================================================================================

选择要归档的轨道（逗号分隔的数字，或 'all'）：

已完成轨道：
[ ] 1. auth_20250110 - 用户身份验证（完成于 2025-01-12）
[ ] 2. setup-ci_20250108 - CI 流水线设置（完成于 2025-01-09）
[ ] 3. docs-update_20250105 - 文档更新（完成于 2025-01-06）

输入选择（例如，"1,3" 或 "all"）：
```

#### 2. 确认选择

```
================================================================================
                       批量归档确认
================================================================================

要归档的轨道：

1. auth_20250110 - 用户身份验证
2. setup-ci_20250108 - CI 流水线设置

所有轨道的归档原因：已完成

操作：
- 将 2 个轨道目录移至 conductor/tracks/_archive/
- 更新 conductor/tracks.md
- 创建 git 提交：chore(conductor): 归档 2 个已完成轨道

================================================================================

输入 'YES' 以继续，或输入任何其他内容取消：
```

#### 3. 执行批量归档

- 依次归档每个轨道
- 所有轨道的单个 git 提交：
  ```bash
  git add conductor/tracks/_archive/ conductor/tracks.md
  git commit -m "chore(conductor): 归档 {N} 个已完成轨道"
  ```

---

## 恢复模式 (`--restore`)

将已归档轨道恢复为活动状态。

### 带参数 (`--restore <track-id>`)

#### 1. 验证轨道

- 检查轨道存在于 `conductor/tracks/_archive/{track-id}/`
- 如果未找到：

  ```
  错误：未找到已归档轨道：{track-id}

  可用的已归档轨道：
  - old-feature_20241201（归档于 2025-01-05）

  用法：/conductor:manage --restore <track-id>
  ```

#### 2. 检查冲突

- 验证 `conductor/tracks/` 中不存在具有相同 ID 的活动轨道
- 如果冲突：

  ```
  错误：无法恢复 '{track-id}' - 具有此 ID 的轨道已存在。

  活动轨道：conductor/tracks/{track-id}/

  选项：
  1. 先删除现有轨道
  2. 使用不同 ID 恢复（将提示输入新 ID）
  3. 取消

  选择选项：
  ```

#### 3. 显示确认

```
================================================================================
                          恢复确认
================================================================================

正在恢复已归档轨道：

轨道：    {track-id} - {title}
类型：     {type}
归档时间： {archived_at}
原因：   {archive_reason}

操作：
- 将 conductor/tracks/_archive/{track-id}/ 移至 conductor/tracks/{track-id}/
- 更新 conductor/tracks.md（移至已完成轨道部分）
- 更新 metadata.json
- 创建 git 提交：chore(conductor): 恢复轨道 '{title}'

注意：轨道将以"已完成"状态恢复。如需要，使用 /conductor:implement
继续工作。

================================================================================

输入 'YES' 以继续，或输入任何其他内容取消：
```

#### 4. 执行恢复

1. 移动轨道目录：

   ```bash
   mv conductor/tracks/_archive/{track-id} conductor/tracks/
   ```

2. 更新 `conductor/tracks/{track-id}/metadata.json`：

   ```json
   {
     "archived": false,
     "restored_at": "ISO_TIMESTAMP",
     "status": "completed"
   }
   ```

3. 更新 `conductor/tracks.md`：
   - 从已归档轨道部分移除条目
   - 将条目添加到已完成轨道部分

4. Git 提交：
   ```bash
   git add conductor/tracks/{track-id} conductor/tracks.md
   git commit -m "chore(conductor): 恢复轨道 '{title}'"
   ```

#### 5. 成功输出

```
================================================================================
                          恢复完成
================================================================================

轨道已恢复：{track-id} - {title}

位置：  conductor/tracks/{track-id}/
状态：    已完成

后续步骤：
- 运行 /conductor:status {track-id} 查看轨道详情
- 运行 /conductor:implement {track-id} 继续工作（如需要）

================================================================================
```

### 不带参数 (`--restore`)

显示已归档轨道的选择菜单：

```
================================================================================
                          恢复轨道
================================================================================

可用于恢复的已归档轨道：

1. old-feature_20241201 - 旧功能（归档于 2025-01-05，原因：被取代）
2. cleanup-api_20241215 - API 清理（归档于 2025-01-10，原因：已完成）

--------------------------------------------------------------------------------

选项：
1-{N}. 选择要恢复的轨道
C.     取消

选择选项：
```

---

## 删除模式 (`--delete`)

永久移除轨道，具有安全确认。

### 带参数 (`--delete <track-id>`)

#### 1. 查找轨道

在以下位置搜索轨道：

1. `conductor/tracks/{track-id}/`（活动/已完成）
2. `conductor/tracks/_archive/{track-id}/`（已归档）

如果未找到：

```
错误：未找到轨道：{track-id}

可用轨道：
活动：
- dashboard_20250112

已归档：
- old-feature_20241201

用法：/conductor:manage --delete <track-id>
```

#### 2. 检查进行中状态

如果轨道状态为 `[~]`（进行中）：

```
================================================================================
                          !! 警告 !!
================================================================================

轨道 '{track-id}' 当前正在进行中。

当前任务：任务 2.3 - {description}
进度：     7/15 任务 (47%)

删除进行中的轨道可能导致工作丢失。

选项：
1. 无论如何删除（使用 --force 跳过此警告）
2. 改为归档（推荐）
3. 取消

选择选项：
```

没有 `--force` 标志，需要明确选择。

#### 3. 显示完整警告

```
================================================================================
                     !! 永久删除警告 !!
================================================================================

轨道：    {track-id} - {title}
类型：     {type}
状态：   {status}
位置： conductor/tracks/{track-id}/（或 _archive/）
创建时间：  {created_date}
文件：    {count}（spec.md、plan.md、metadata.json、index.md）
提交：  {count} 个相关提交（不会被删除）

此操作无法撤消。轨道目录和所有内容
将被永久移除。

考虑改为归档：/conductor:manage --archive {track-id}

================================================================================

输入 'DELETE' 以永久移除，或输入任何其他内容取消：
```

**关键：需要确切的 'DELETE' 字符串，而不是 'yes' 或 'y'。**

#### 4. 执行删除

1. 移除轨道目录：

   ```bash
   rm -rf conductor/tracks/{track-id}
   # 或
   rm -rf conductor/tracks/_archive/{track-id}
   ```

2. 更新 `conductor/tracks.md`：
   - 从相应部分（活动、已完成或已归档）移除条目

3. Git 提交：
   ```bash
   git add conductor/tracks.md
   git commit -m "chore(conductor): 删除轨道 '{title}'"
   ```

注意：git 提交记录删除，但不移除历史提交。

#### 5. 成功输出

```
================================================================================
                          删除完成
================================================================================

轨道已永久删除：{track-id} - {title}

注意：Git 历史仍包含引用此轨道的提交。
      轨道目录和注册表条目已被移除。

================================================================================
```

### 不带参数 (`--delete`)

显示所有轨道的选择菜单：

```
================================================================================
                          删除轨道
================================================================================

!! 这将永久删除轨道 !!

选择要删除的轨道：

活动/已完成：
1. [ ] nav-fix_20250114 - 导航 Bug 修复
2. [x] auth_20250110 - 用户身份验证

已归档：
3. old-feature_20241201 - 旧功能

--------------------------------------------------------------------------------

选项：
1-{N}. 选择要删除的轨道
C.     取消

选择选项：
```

---

## 重命名模式 (`--rename`)

更改轨道 ID，具有完整的引用更新。

### 带参数 (`--rename <old-id> <new-id>`)

#### 1. 验证旧轨道存在

检查轨道存在于：

- `conductor/tracks/{old-id}/`
- `conductor/tracks/_archive/{old-id}/`

如果未找到：

```
错误：未找到轨道：{old-id}

可用轨道：
- auth_20250110
- dashboard_20250112

用法：/conductor:manage --rename <old-id> <new-id>
```

#### 2. 验证新 ID

**检查格式**（必须匹配 `{shortname}_{YYYYMMDD}`）：

```
错误：无效的轨道 ID 格式：{new-id}

轨道 ID 必须遵循模式：{shortname}_{YYYYMMDD}
示例：
- user-auth_20250115
- fix-login_20250114
- api-v2_20250110
```

**检查无冲突：**

```
错误：轨道 '{new-id}' 已存在。

选择不同的 ID 或先删除现有轨道。
```

#### 3. 显示确认

```
================================================================================
                          重命名轨道
================================================================================

当前：  {old-id} - {title}
新 ID：   {new-id}

更改：
- 将 conductor/tracks/{old-id}/ 重命名为 {new-id}/
- 更新 tracks.md 条目
- 更新 metadata.json id 字段
- 更新 plan.md 轨道 ID 标题

注意：Git 提交历史将保留原始轨道 ID 引用。
      相关提交无法重命名。

================================================================================

输入 'YES' 以继续，或输入任何其他内容取消：
```

#### 4. 执行重命名

1. 重命名目录：

   ```bash
   mv conductor/tracks/{old-id} conductor/tracks/{new-id}
   # 或对于已归档：
   mv conductor/tracks/_archive/{old-id} conductor/tracks/_archive/{new-id}
   ```

2. 更新 `conductor/tracks/{new-id}/metadata.json`：

   ```json
   {
     "id": "{new-id}",
     "previous_ids": ["{old-id}"],
     "renamed_at": "ISO_TIMESTAMP"
   }
   ```

   如果 `previous_ids` 已存在，则追加旧 ID。

3. 更新 `conductor/tracks/{new-id}/plan.md`：
   - 更改标题行中的轨道 ID

4. 更新 `conductor/tracks.md`：
   - 更新相应部分中的轨道 ID
   - 更新文件夹链接路径

5. Git 提交：
   ```bash
   git add conductor/tracks/{new-id} conductor/tracks.md
   git commit -m "chore(conductor): 将轨道 '{old-id}' 重命名为 '{new-id}'"
   ```

#### 5. 成功输出

```
================================================================================
                          重命名完成
================================================================================

轨道已重命名：{old-id} → {new-id}

新位置：conductor/tracks/{new-id}/

注意：历史 git 提交仍引用 '{old-id}'。

================================================================================
```

### 不带参数 (`--rename`)

交互式模式：

```
================================================================================
                          重命名轨道
================================================================================

选择要重命名的轨道：

1. auth_20250110 - 用户身份验证
2. dashboard_20250112 - 仪表板功能
3. nav-fix_20250114 - 导航 Bug 修复

--------------------------------------------------------------------------------

选项：
1-{N}. 选择轨道
C.     取消

选择选项：
```

选择后：

```
为 '{old-id}' 输入新轨道 ID：

格式：{shortname}_{YYYYMMDD}
当前：{old-id}

新 ID：
```

---

## 清理模式 (`--cleanup`)

检测并修复孤立的轨道工件。

### 1. 扫描问题

**目录孤立：**

- 扫描 `conductor/tracks/` 查找目录
- 对照 tracks.md 条目检查每个目录
- 标记不在注册表中的目录

**注册表孤立：**

- 解析 tracks.md 查找所有轨道条目
- 检查每个条目是否具有相应的目录
- 标记没有目录的条目

**不完整的轨道：**

- 对于每个轨道目录，验证必需文件是否存在：
  - `spec.md`
  - `plan.md`
  - `metadata.json`
- 标记缺少必需文件的轨道

**陈旧的进行中：**

- 查找状态为 `[~]` 的轨道
- 检查 `metadata.json` `updated` 时间戳
- 如果超过 7 天未修改则标记

### 2. 显示结果

```
================================================================================
                          轨道清理
================================================================================

正在扫描问题...

孤立目录（不在 tracks.md 中）：
  1. conductor/tracks/test-feature_20241201/
  2. conductor/tracks/experiment_20241220/

注册表孤立（没有匹配的文件夹）：
  3. broken-track_20250101（在 tracks.md 中列出）

不完整的轨道（缺少文件）：
  4. partial_20250105/ - 缺少：metadata.json、index.md

陈旧的进行中（超过 7 天未修改）：
  5. old-work_20250101 - 最后更新：2025-01-02

================================================================================

发现 {N} 个问题。

操作：
1. 将孤立目录添加到 tracks.md
2. 从 tracks.md 中移除注册表孤立
3. 从模板创建缺少的文件
4. 归档陈旧轨道
A. 自动修复所有问题
S. 跳过并手动审查
C. 取消

选择操作：
```

### 3. 处理无问题

```
================================================================================
                          轨道清理
================================================================================

正在扫描问题...

未发现问题。

所有轨道都已正确注册并完整。

================================================================================
```

### 4. 执行修复

**对于目录孤立（操作 1）：**

```
正在将孤立目录添加到 tracks.md...

对于每个目录：
- 如果存在 metadata.json，读取它以获取轨道信息
- 如果没有元数据，提示输入轨道详情：

  找到：conductor/tracks/test-feature_20241201/

  输入轨道标题（或 'skip' 忽略）：
  输入轨道类型（feature/bug/chore/refactor）：

- 将条目添加到 tracks.md 中的适当部分
- 如果缺少则创建 metadata.json
```

**对于注册表孤立（操作 2）：**

```
正在从 tracks.md 中移除注册表孤立...

已移除的条目：
- broken-track_20250101

注意：没有删除文件，仅更新了 tracks.md。
```

**对于不完整的轨道（操作 3）：**

```
正在从模板创建缺少的文件...

partial_20250105/：
- 已从模板创建 metadata.json
- 已从模板创建 index.md

注意：您可能需要用实际内容填充这些文件。
```

**对于陈旧的进行中（操作 4）：**

```
正在归档陈旧轨道...

old-work_20250101：
- 已归档，原因：陈旧（自 2025-01-02 以来未修改）
```

**对于所有问题（操作 A）：**

依次执行所有适用的修复，然后：

```bash
git add conductor/
git commit -m "chore(conductor): 清理 {N} 个孤立轨道工件"
```

### 5. 完成输出

```
================================================================================
                          清理完成
================================================================================

已修复 {N} 个问题：
- 将 {X} 个孤立目录添加到 tracks.md
- 移除了 {Y} 个注册表孤立
- 为 {Z} 个不完整轨道创建了缺少的文件
- 归档了 {W} 个陈旧轨道

提交：{sha}

================================================================================
```

---

## 错误处理

### Git 操作失败

```
GIT 错误：{error message}

操作部分完成：
- 目录已移动：是/否
- tracks.md 已更新：是/否
- 已创建提交：否

您可能需要手动：
1. 完成 git 提交
2. 从当前位置恢复文件

当前状态：
- 轨道位置：{path}
- tracks.md：{status}

重试提交：
  git add conductor/tracks.md conductor/tracks/{track-id}
  git commit -m "{预期消息}"
```

### 文件系统错误

```
错误：无法 {operation}：{error}

可能原因：
- 权限被拒绝
- 磁盘已满
- 文件正在使用

未做任何更改。请解决问题后重试。
```

### 无效参数

```
错误：无效参数：{argument}

用法：/conductor:manage [--archive | --restore | --delete | --rename | --list | --cleanup]

示例：
  /conductor:manage                     # 交互式模式
  /conductor:manage --list              # 列出所有轨道
  /conductor:manage --list archived     # 仅列出已归档轨道
  /conductor:manage --archive track-id  # 归档特定轨道
  /conductor:manage --restore track-id  # 恢复已归档轨道
  /conductor:manage --delete track-id   # 永久删除轨道
  /conductor:manage --rename old new    # 重命名轨道 ID
  /conductor:manage --cleanup           # 修复孤立工件
```

---

## 关键规则

1. **始终验证轨道存在** - 在任何操作之前
2. **需要明确确认** - 对于破坏性操作：
   - 'YES' 用于归档、恢复、重命名
   - 'DELETE' 用于永久删除
3. **任何错误时停止** - 不要尝试在失败后继续
4. **更新 tracks.md** - 保持注册表与文件系统同步
5. **提交更改** - 创建 git 提交以实现可追溯性
6. **保留历史** - Git 提交永远不会被修改或删除
7. **警告进行中** - 修改活动工作时需要格外小心
8. **提供替代方案** - 在删除之前建议归档
