---
name: team-composition-patterns
description: 使用规模启发式、预设配置和智能体类型选择设计最佳智能体团队组合。在决定团队规模、选择智能体类型或为多智能体工作流程配置团队预设时使用此技能。
version: 1.0.2
---

# 团队组合模式

为组合多智能体团队、选择团队规模、选择智能体类型以及为 Claude Code 的 Agent Teams 功能配置显示模式的最佳实践。

## 何时使用此技能

- 决定为任务生成多少个队友
- 在预设团队配置之间选择
- 为每个角色选择正确的智能体类型(subagent_type)
- 配置队友显示模式(tmux、iTerm2、in-process)
- 为非标准工作流程构建自定义团队组合

## 团队规模启发式

| 复杂度     | 团队规模 | 何时使用                                                 |
| ---------- | -------- | -------------------------------------------------------- |
| 简单       | 1-2      | 单维度审查、隔离的 bug、小功能                            |
| 中等       | 2-3      | 多文件更改、2-3 个关注点、中等功能                        |
| 复杂       | 3-4      | 跨越关注点、大型功能、深度调试                            |
| 非常复杂   | 4-5      | 全栈功能、综合审查、系统性问题                            |

**经验法则**: 从覆盖所有所需维度的最小团队开始。增加队友会增加协调开销。

## 预设团队组合

### 审查团队

- **规模**: 3 个审查者
- **智能体**: 3x `team-reviewer`
- **默认维度**: 安全、性能、架构
- **用于**: 代码更改需要多维度质量评估

### 调试团队

- **规模**: 3 个调查者
- **智能体**: 3x `team-debugger`
- **默认假设**: 3 个竞争假设
- **用于**: Bug 有多个合理的根本原因

### 功能团队

- **规模**: 3 个(1 个领导者 + 2 个实现者)
- **智能体**: 1x `team-lead` + 2x `team-implementer`
- **用于**: 功能可以分解为并行工作流

### 全栈团队

- **规模**: 4 个(1 个领导者 + 3 个实现者)
- **智能体**: 1x `team-lead` + 1x 前端 `team-implementer` + 1x 后端 `team-implementer` + 1x 测试 `team-implementer`
- **用于**: 功能跨越前端、后端和测试层

### 研究团队

- **规模**: 3 个研究者
- **智能体**: 3x `general-purpose`
- **默认区域**: 每个分配不同的研究问题、模块或主题
- **能力**: 代码库搜索(Grep、Glob、Read)、网络搜索(WebSearch、WebFetch)
- **用于**: 需要了解代码库、研究库、比较方法或从代码和网络源并行收集信息

### 安全团队

- **规模**: 4 个审查者
- **智能体**: 4x `team-reviewer`
- **默认维度**: OWASP/漏洞、认证/访问控制、依赖/供应链、机密/配置
- **用于**: 覆盖多个攻击面的综合安全审计

### 迁移团队

- **规模**: 4 个(1 个领导者 + 2 个实现者 + 1 个审查者)
- **智能体**: 1x `team-lead` + 2x `team-implementer` + 1x `team-reviewer`
- **用于**: 大型代码库迁移(框架升级、语言移植、API 版本升级),需要并行工作和正确性验证

## 智能体类型选择

使用 Task 工具生成队友时,根据队友需要的工具选择 `subagent_type`:

| 智能体类型                   | 可用工具                                    | 用于                                                    |
| ---------------------------- | ------------------------------------------- | ------------------------------------------------------- |
| `general-purpose`            | 所有工具(Read、Write、Edit、Bash 等)         | 实现、调试、任何需要文件更改的任务                       |
| `Explore`                    | 只读工具(Read、Grep、Glob)                  | 研究、代码探索、分析                                     |
| `Plan`                       | 只读工具                                    | 架构规划、任务分解                                       |
| `agent-teams:team-reviewer`  | 所有工具                                    | 具有结构化发现的代码审查                                 |
| `agent-teams:team-debugger`  | 所有工具                                    | 假设驱动调查                                             |
| `agent-teams:team-implementer` | 所有工具                                  | 在文件所有权边界内构建功能                               |
| `agent-teams:team-lead`      | 所有工具                                    | 团队编排和协调                                           |

**关键区别**: 只读智能体(Explore、Plan)不能修改文件。永远不要向只读智能体分配实现任务。

## 显示模式配置

在 `~/.claude/settings.json` 中配置:

```json
{
  "teammateMode": "tmux"
}
```

| 模式           | 行为                      | 最适合                                         |
| -------------- | ------------------------- | ---------------------------------------------- |
| `"tmux"`       | 每个队友在一个 tmux 窗格中 | 开发工作流程、监控多个智能体                    |
| `"iterm2"`     | 每个队友在一个 iTerm2 标签页中 | 偏好 iTerm2 的 macOS 用户                      |
| `"in-process"` | 所有队友在同一进程中       | 简单任务、CI/CD 环境                            |

## 自定义团队指南

构建自定义团队时:

1. **每个团队都需要协调者** — 指定一个 `team-lead` 或让用户直接协调
2. **将角色与智能体类型匹配** — 可用时使用专门的智能体(reviewer、debugger、implementer)
3. **避免重复角色** — 两个智能体做同样的事情浪费资源
4. **提前定义边界** — 每个队友都需要对文件或职责的清晰所有权
5. **保持小团队** — 2-4 个队友是最佳点;5+ 需要大量的协调开销
