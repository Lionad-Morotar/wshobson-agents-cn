---
name: task-coordination-strategies
description: 分解复杂任务、设计依赖图,并通过适当的任务描述和工作负载平衡来协调多智能体工作。在为智能体团队分解工作、管理任务依赖或监控团队进度时使用此技能。
version: 1.0.2
---

# 任务协调策略

将复杂任务分解为可并行单元、设计依赖图、编写有效的任务描述以及监控跨智能体团队的工作负载的策略。

## 何时使用此技能

- 将复杂任务分解以并行执行
- 设计任务依赖关系(blockedBy/blocks)
- 编写具有清晰验收标准的任务描述
- 监控和重新平衡跨队友的工作负载
- 识别多任务工作流程中的关键路径

## 任务分解策略

### 按层

按架构层拆分工作:

- 前端组件
- 后端 API 端点
- 数据库迁移/模型
- 测试套件

**最适合**: 全栈功能、垂直切片

### 按组件

按功能组件拆分工作:

- 认证模块
- 用户配置文件模块
- 通知模块

**最适合**: 微服务、模块化架构

### 按关注点

按跨越关注点拆分工作:

- 安全审查
- 性能审查
- 架构审查

**最适合**: 代码审查、审计

### 按文件所有权

按文件/目录边界拆分工作:

- `src/components/` — 实现者 1
- `src/api/` — 实现者 2
- `src/utils/` — 实现者 3

**最适合**: 并行实现、冲突避免

## 依赖图设计

### 原则

1. **最小化链深度** — 偏好宽、浅图而不是深链
2. **识别关键路径** — 最长的链决定最小完成时间
3. **谨慎使用 blockedBy** — 仅添加真正需要的依赖
4. **避免循环依赖** — 任务 A 阻塞 B 阻塞 A 是死锁

### 模式

**独立(最佳并行性)**:

```
任务 A ─┐
任务 B ─┼─→ 集成
任务 C ─┘
```

**顺序(必要依赖)**:

```
任务 A → 任务 B → 任务 C
```

**菱形(混合)**:

```
        ┌→ 任务 B ─┐
任务 A ─┤          ├→ 任务 D
        └→ 任务 C ─┘
```

### 使用 blockedBy/blocks

```
TaskCreate: { subject: "构建 API 端点" }         → 任务 #1
TaskCreate: { subject: "构建前端组件" }    → 任务 #2
TaskCreate: { subject: "集成测试" }          → 任务 #3
TaskUpdate: { taskId: "3", addBlockedBy: ["1", "2"] }  → #3 等待 #1 和 #2
```

## 任务描述最佳实践

每个任务都应包括:

1. **目标** — 需要完成什么(1-2 句话)
2. **拥有的文件** — 此队友可以修改的文件/目录的明确列表
3. **要求** — 预期的具体可交付成果或行为
4. **接口契约** — 此工作如何与其他队友的工作连接
5. **验收标准** — 如何验证任务正确完成
6. **范围边界** — 明确排除的内容

### 模板

```
## 目标
构建用户认证 API 端点。

## 拥有的文件
- src/api/auth.ts
- src/api/middleware/auth-middleware.ts
- src/types/auth.ts(共享 — 只读,不要修改)

## 要求
- POST /api/login — 接受 email/password,返回 JWT
- POST /api/register — 创建新用户,返回 JWT
- GET /api/me — 返回当前用户配置文件(需要认证)

## 接口契约
- 从 src/types/auth.ts 导入 User 类型(由 implementer-1 拥有)
- 导出 AuthResponse 类型供前端使用

## 验收标准
- 所有端点返回正确的 HTTP 状态码
- JWT 令牌在 24 小时后过期
- 密码使用 bcrypt 哈希

## 超出范围
- OAuth/社交登录
- 密码重置流程
- 速率限制
```

## 工作负载监控

### 不平衡的指标

| 信号                     | 含义             | 操作                      |
| ------------------------ | ---------------- | ------------------------- |
| 队友空闲,其他忙          | 分布不均         | 重新分配待处理任务         |
| 队友卡在一个任务上       | 可能的阻塞       | 检查,提供帮助              |
| 所有任务被阻塞           | 依赖问题         | 先解决关键路径             |
| 一个队友有其他队友的 3 倍 | 过载             | 拆分任务或重新分配         |

### 重新平衡步骤

1. 调用 `TaskList` 评估当前状态
2. 识别空闲或过载的队友
3. 使用 `TaskUpdate` 重新分配任务
4. 使用 `SendMessage` 通知受影响的队友
5. 监控改进的吞吐量
